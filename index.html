<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Two Graphs UI</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 0;
    }

    nav {
      width: 100%;
      background-color: #333;
      color: white;
      padding: 10px 0;
      text-align: center;
      position: relative;
    }

    .search-bar {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50%;
    }

    .search-bar input {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    footer {
      width: 100%;
      background-color: #333;
      color: white;
      padding: 10px 0;
      text-align: center;
      position: fixed;
      bottom: 0;
    }

    .graph-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      width: 90%;
      margin: 20px 0;
    }

    .graph {
      flex: 1;
      min-width: 300px;
      max-width: 45%;
      margin: 10px;
    }
  </style>
</head>

<body>

  <nav>
    <h2>DIV Tennis
    </h2>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <div class="search-bar">
      <input type="text" placeholder="Search...">
    </div>
  </nav>

  <h1>Main Summary</h1>
  <div class="graph-container">
    <canvas id="graph1" class="graph"></canvas>
    <canvas id="graph2" class="graph"></canvas>
  </div>

  <footer>
    <p>&copy; 2024 Graphs Dashboard. All rights reserved.</p>
  </footer>

  <script>
    // Graph 1 Configuration
    // Fetch data from JSON file
    fetch('./injury_vs_court_type.json')
      .then(response => response.json())
      .then(data => {
        const count_injured_hard = data.Hard.Injured;
        const count_non_injured_hard = data.Hard['Non-Injured'];
        const count_injured_clay = data.Clay.Injured;
        const count_non_injured_clay = data.Clay['Non-Injured'];
        const count_injured_grass = data.Grass.Injured;
        const count_non_injured_grass = data.Grass['Non-Injured'];

        const ctx1 = document.getElementById('graph1').getContext('2d');
        new Chart(ctx1, {
          type: 'line',
          data: {
            labels: ['Injured', 'Non-Injured'], // labels for x-axis
            datasets: [{
              label: 'Hard Court',
              data: [count_injured_hard, count_non_injured_hard], // data for y-axis
              borderColor: 'rgba(75, 192, 192, 1)',
              borderWidth: 2,
              fill: false
            },
            {
              label: 'Clay Court',
              data: [count_injured_clay, count_non_injured_clay], // data for y-axis
              borderColor: 'rgba(192, 192, 75, 1)',
              borderWidth: 2,
              fill: false
            },
            {
              label: 'Grass Court',
              data: [count_injured_grass, count_non_injured_grass], // data for y-axis
              borderColor: 'rgba(192, 75, 192, 1)',
              borderWidth: 2,
              fill: false
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                display: true
              }
            }
          }
        });
      })
      .catch(error => console.error('Error fetching data:', error));

    // Graph 2 Configuration (main faceted bar graph)
    fetch('./weather_data.json')
      .then(response => response.json())
      .then(data => {
        const ctx2 = document.getElementById('graph2').getContext('2d');

        // Prepare data
        const labels = ['Partly Cloudy [Code: 1]', 'Clear [Code: 2]', 'Cloudy [Code: 3]', 'Smoky [Code: 4]', 'Haze [Code: 5]'];
        const injuredData = [
          data["Partly cloudy"].Injured,
          data.Clear.Injured,
          data.Cloudy.Injured,
          data.Smoky.Injured,
          data.Haze.Injured
        ];
        const nonInjuredData = [
          data["Partly cloudy"]['Non-Injured'],
          data.Clear['Non-Injured'],
          data.Cloudy['Non-Injured'],
          data.Smoky['Non-Injured'],
          data.Haze['Non-Injured']
        ];

        // Custom Plugin for separators
        const separatorPlugin = {
          id: 'separator',
          beforeDraw: (chart) => {
            const ctx = chart.ctx;
            const xScale = chart.scales.x;
            const yScale = chart.scales.y;

            ctx.save();
            ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.lineWidth = 2;

            // Draw vertical separator lines
            labels.forEach((label, index) => {
              const xPosition = xScale.getPixelForTick(index);
              if (index > 0) {
                ctx.beginPath();
                ctx.moveTo(xPosition - xScale.width / (labels.length * 2), yScale.top);
                ctx.lineTo(xPosition - xScale.width / (labels.length * 2), yScale.bottom);
                ctx.stroke();
              }
            });

            ctx.restore();
          }
        };

        // Create the chart
        new Chart(ctx2, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [
              {
                label: 'Injured',
                data: injuredData,
                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
              },
              {
                label: 'Non-Injured',
                data: nonInjuredData,
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                display: true,
                position: 'top',
                labels: {
                  font: {
                    size: 14
                  }
                }
              }
            },
            scales: {
              x: {
                stacked: false,
                ticks: {
                  font: {
                    size: 12
                  }
                },
                grid: {
                  drawOnChartArea: false // only want the grid lines for one axis to show up
                },
                barPercentage: 0.7, // bar width
                categoryPercentage: 0.5 // space between bars
              },
              y: {
                beginAtZero: true
              }
            }
          },
          plugins: [separatorPlugin] // Register custom plugin
        });
      })
      .catch(error => console.error('Error fetching data:', error));
  </script>

</html>